<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Db (current.Current_cache.Db)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">current</a> &#x00BB; <a href="../index.html">Current_cache</a> &#x00BB; Db</nav><h1>Module <code>Current_cache.Db</code></h1><p>Low-level database access (for the web UI and plugins).</p></header><dl><dt class="spec type" id="type-entry"><a href="#type-entry" class="anchor"></a><code><span class="keyword">type</span> entry</code><code> = </code><code>{</code><table class="record"><tr id="type-entry.job_id" class="anchored"><td class="def field"><a href="#type-entry.job_id" class="anchor"></a><code>job_id : string;</code></td></tr><tr id="type-entry.build" class="anchored"><td class="def field"><a href="#type-entry.build" class="anchor"></a><code>build : int64;</code></td></tr><tr id="type-entry.value" class="anchored"><td class="def field"><a href="#type-entry.value" class="anchor"></a><code>value : string;</code></td></tr><tr id="type-entry.outcome" class="anchored"><td class="def field"><a href="#type-entry.outcome" class="anchor"></a><code>outcome : <span>string <a href="../../Current/index.html#type-or_error">Current.or_error</a></span>;</code></td></tr><tr id="type-entry.ready" class="anchored"><td class="def field"><a href="#type-entry.ready" class="anchor"></a><code>ready : float;</code></td></tr><tr id="type-entry.running" class="anchored"><td class="def field"><a href="#type-entry.running" class="anchor"></a><code>running : <span>float option</span>;</code></td></tr><tr id="type-entry.finished" class="anchored"><td class="def field"><a href="#type-entry.finished" class="anchor"></a><code>finished : float;</code></td></tr><tr id="type-entry.rebuild" class="anchored"><td class="def field"><a href="#type-entry.rebuild" class="anchor"></a><code>rebuild : bool;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val</span> init : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Ensure that the database tables have been created. This is useful if you need to refer to them in your own SQL.</p></dd></dl><dl><dt class="spec value" id="val-query"><a href="#val-query" class="anchor"></a><code><span class="keyword">val</span> query : <span>?&#8288;op:string</span> <span>&#45;&gt;</span> <span>?&#8288;ok:bool</span> <span>&#45;&gt;</span> <span>?&#8288;rebuild:bool</span> <span>&#45;&gt;</span> <span>?&#8288;job_prefix:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span><a href="index.html#type-entry">entry</a> list</span></code></dt><dd><p>Search the database for matching records.</p><dl><dt>parameter op</dt><dd><p>: if present, restrict to results from the named builder or publisher</p></dd></dl><dl><dt>parameter ok</dt><dd><p>: if present, restrict results to passing (ok=true) or failing (ok=false) results.</p></dd></dl><dl><dt>parameter rebuild</dt><dd><p>: if present, restrict results to ones where the rebuild flag matches this.</p></dd></dl><dl><dt>parameter job_prefix</dt><dd><p>: if present, restrict results to ones where the job ID starts with this string.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-ops"><a href="#val-ops" class="anchor"></a><code><span class="keyword">val</span> ops : unit <span>&#45;&gt;</span> <span>string list</span></code></dt><dd><p><code>ops ()</code> is the list of operation types that can be passed to <code>query</code>.</p></dd></dl><dl><dt class="spec value" id="val-history"><a href="#val-history" class="anchor"></a><code><span class="keyword">val</span> history : <span>limit:int</span> <span>&#45;&gt;</span> <span>job_id:string</span> <span>&#45;&gt;</span> <span>string option</span> * <span><a href="index.html#type-entry">entry</a> list</span></code></dt><dd><p><code>history ~limit ~job_id</code> returns the in-progress build (if any), and the <code>limit</code> most recent builds with the same key as <code>job_id</code>.</p></dd></dl></div></body></html>